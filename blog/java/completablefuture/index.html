<!doctype html><html itemscope lang=ko-kr itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=5"><meta name=theme-name content="hugoplate"><meta name=naver-site-verification content="d4d26f3ed3d3a269e15a545d23cb4b736e12d34a"><link rel="shortcut icon" href=/images/favicon_hu2575224fe8b7f0ea91e8825e42ecaf67_1499445_96x0_resize_lanczos_3.png type=image/x-icon><link rel=icon href=/images/favicon_hu2575224fe8b7f0ea91e8825e42ecaf67_1499445_96x0_resize_lanczos_3.png type=image/x-icon><link rel=icon type=image/png sizes=48x48 href=/images/favicon_hu2575224fe8b7f0ea91e8825e42ecaf67_1499445_48x0_resize_lanczos_3.png><link rel=icon type=image/png sizes=96x96 href=/images/favicon_hu2575224fe8b7f0ea91e8825e42ecaf67_1499445_96x0_resize_lanczos_3.png><link rel=apple-touch-icon sizes=144x144 href=/images/favicon_hu2575224fe8b7f0ea91e8825e42ecaf67_1499445_144x0_resize_lanczos_3.png><link rel=manifest href=/manifest.webmanifest><meta name=msapplication-TileColor content="#ddd"><meta name=theme-color content="#ffffff"><base href=https://gowoonsori.com/blog/java/completablefuture/><title>Java CompletableFuture</title>
<meta name=generator content="Hugo 0.120.2"><meta name=keywords content="Gromit,Tech,Blog,gowoonsori"><meta name=description content="java8에 추가된 CompletableFuture에 대해 설명합니다."><meta name=author content="gowoonsori"><meta property="og:image" content="https://gowoonsori.com/images/java/java.jpg"><meta name=twitter:image content="https://gowoonsori.com/images/java/java.jpg"><meta name=twitter:card content="summary
            _large_image
          "><meta property="og:image:width" content="1280"><meta property="og:image:height" content="768"><meta property="og:image:type" content="image/
        .jpg
      "><meta property="og:title" content="Java CompletableFuture"><meta property="og:description" content="java8에 추가된 CompletableFuture에 대해 설명합니다."><meta property="og:type" content="website"><meta property="og:url" content="https://gowoonsori.com/blog/java/completablefuture/"><meta name=twitter:title content="Java CompletableFuture"><meta name=twitter:description content="java8에 추가된 CompletableFuture에 대해 설명합니다."><script async src="https://www.googletagmanager.com/gtag/js?id=G-NB8ZZY0RDG"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-NB8ZZY0RDG",{anonymize_ip:!1})}</script><script>!function(){let e=0;document.addEventListener("mousemove",function(){1==++e&&gtmLoader()}),window.onscroll=function(){1==++e&&gtmLoader()},setTimeout(function(){0===e&&(e++,gtmLoader())},5e3)}();function gtmLoader(){(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","G-NB8ZZY0RDG")}</script><script>let indexURL="https://gowoonsori.com/searchindex.json",includeSectionsInSearch=["blog"],no_results_for="No results for",empty_search_results_placeholder="Type something to search.."</script><meta http-equiv=x-dns-prefetch-control content="on"><link rel=preconnect href=https://use.fontawesome.com crossorigin><link rel=preconnect href=//cdnjs.cloudflare.com><link rel=preconnect href=//www.googletagmanager.com><link rel=preconnect href=//www.google-analytics.com><link rel=dns-prefetch href=https://use.fontawesome.com><link rel=dns-prefetch href=//ajax.googleapis.com><link rel=dns-prefetch href=//cdnjs.cloudflare.com><link rel=dns-prefetch href=//www.googletagmanager.com><link rel=dns-prefetch href=//www.google-analytics.com><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//connect.facebook.net><link rel=dns-prefetch href=//platform.linkedin.com><link rel=dns-prefetch href=//platform.twitter.com><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;600&family=Signika:wght@500;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script><link href="/css/style.min.7f79edb8cd8b89cf1fa077c3ef1fc27c23db7dbf0f36180213e0101f52c366f2.css" integrity="sha256-f3ntuM2Lic8foHfD7x/CfCPbfb8PNhgCE+AQH1LDZvI=" rel=stylesheet><link rel=stylesheet href="/css/style-lazy.min.6ebccd46bdfd6a8861cd49c725f28b8615081591f753245c453e861a11c4b5b4.css" integrity="sha256-brzNRr39aohhzUnHJfKLhhUIFZH3UyRcRT6GGhHEtbQ=" media=print onload='this.media="all",this.onload=null'></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=G-NB8ZZY0RDG" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><header class="header sticky top-0 z-30"><nav class="navbar container"><div class=order-0><a class="navbar-brand block" href=/><img fetchpriority=high decoding=async class="img logo-light" width=160 height=32 src=/images/logo_huecbda5afdfa6f2a47d87fa44d8964534_89529_320x0_resize_q90_h2_lanczos_3.webp alt=Gromit.Blog onerror='this.onerror=null,this.src="/images/logo_huecbda5afdfa6f2a47d87fa44d8964534_89529_320x0_resize_lanczos_3.png"'>
<img fetchpriority=high decoding=async class="img logo-dark" width=160 height=32 src=/images/logo-darkmode_hu2877729f4be0141a60f84355100d8d94_80775_320x0_resize_q90_h2_lanczos_3.webp alt=Gromit.Blog onerror='this.onerror=null,this.src="/images/logo-darkmode_hu2877729f4be0141a60f84355100d8d94_80775_320x0_resize_lanczos_3.png"'></a></div><input id=nav-toggle type=checkbox class=hidden>
<label for=nav-toggle class="order-3 cursor-pointer flex items-center lg:hidden text-dark dark:text-white lg:order-1"><svg id="show-button" class="h-6 fill-current block" viewBox="0 0 20 20"><title>Menu Open</title><path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0V0z"/></svg><svg id="hide-button" class="h-6 fill-current hidden" viewBox="0 0 20 20"><title>Menu Close</title><polygon points="11 9 22 9 22 11 11 11 11 22 9 22 9 11 -2 11 -2 9 9 9 9 -2 11 -2" transform="rotate(45 10 10)"/></svg></label><ul id=nav-menu class="navbar-nav order-3 hidden lg:flex w-full pb-6 lg:order-1 lg:w-auto lg:space-x-2 lg:pb-0 xl:space-x-8"><li class=nav-item><a class=nav-link href=/blog/>Blog</a></li><li class=nav-item><a class=nav-link href=/categories/>Categories</a></li><li class=nav-item><a class=nav-link href=/tags/>Tags</a></li><li class=nav-item><a class=nav-link href=/about>About</a></li></ul><div class="order-1 ml-auto flex items-center md:order-2 lg:ml-0"><button aria-label=search class="border-border text-dark hover:text-primary dark:border-darkmode-border mr-5 inline-block border-r pr-5 text-xl dark:text-white" data-target=search-modal>
<i class="fa-solid fa-search"></i></button><div class="theme-switcher mr-5"><input id=theme-switcher data-theme-switcher type=checkbox>
<label for=theme-switcher><span class=sr-only>theme switcher</span>
<span><svg class="absolute left-[4px] top-[4px] z-10 opacity-100 dark:opacity-0" viewBox="0 0 56 56" fill="#fff" height="16" width="16"><path d="M30 4.6c0-1-.9-2-2-2a2 2 0 00-2 2v5c0 1 .9 2 2 2s2-1 2-2zm9.6 9a2 2 0 000 2.8c.8.8 2 .8 2.9.0L46 13a2 2 0 000-2.9 2 2 0 00-3 0zm-26 2.8c.7.8 2 .8 2.8.0.8-.7.8-2 0-2.9L13 10c-.7-.7-2-.8-2.9.0-.7.8-.7 2.1.0 3zM28 16A12 12 0 0016 28a12 12 0 0012 12 12 12 0 0012-12A12 12 0 0028 16zm23.3 14c1.1.0 2-.9 2-2s-.9-2-2-2h-4.9a2 2 0 00-2 2c0 1.1 1 2 2 2zM4.7 26a2 2 0 00-2 2c0 1.1.9 2 2 2h4.9c1 0 2-.9 2-2s-1-2-2-2zm37.8 13.6a2 2 0 00-3 0 2 2 0 000 2.9l3.6 3.5a2 2 0 002.9.0c.8-.8.8-2.1.0-3zM10 43.1a2 2 0 000 2.9c.8.7 2.1.8 3 0l3.4-3.5c.8-.8.8-2.1.0-2.9s-2-.8-2.9.0zm20 3.4c0-1.1-.9-2-2-2a2 2 0 00-2 2v4.9c0 1 .9 2 2 2s2-1 2-2z"/></svg><svg class="absolute left-[4px] top-[4px] z-10 opacity-0 dark:opacity-100" viewBox="0 0 24 24" fill="none" height="16" width="16"><path fill="#000" fill-rule="evenodd" clip-rule="evenodd" d="M8.2 2.2c1-.4 2 .6 1.6 1.5-1 3-.4 6.4 1.8 8.7a8.4 8.4.0 008.7 1.8c1-.3 2 .5 1.5 1.5v.1A10.3 10.3.0 0112.4 22 10.3 10.3.0 013.2 6.7c1-2 2.9-3.5 4.9-4.4z"/></svg></span></label></div><script>var darkMode=!0,themeSwitch;localStorage.getItem("theme")==="dark"?darkMode=!0:localStorage.getItem("theme")==="light"&&(darkMode=!1),darkMode&&document.documentElement.classList.toggle("dark"),themeSwitch=document.querySelectorAll("[data-theme-switcher]"),document.addEventListener("DOMContentLoaded",()=>{[].forEach.call(themeSwitch,function(e){e.checked=!!darkMode,e.addEventListener("click",()=>{document.documentElement.classList.toggle("dark"),localStorage.setItem("theme",document.documentElement.classList.contains("dark")?"dark":"light"),setGiscusTheme()})})});function getGiscusTheme(){return localStorage.getItem("theme")==="dark"?"dark":"light"}function setGiscusTheme(){function e(e){const t=document.querySelector("iframe.giscus-frame");if(!t)return;t.contentWindow.postMessage({giscus:e},"https://giscus.app")}e({setConfig:{theme:getGiscusTheme()}})}</script></div></nav></header><div class="search-wrapper search-modal" data-image=true data-description=true data-tags=true data-categories=true tabindex=-1 aria-hidden=true style=--color-primary:#121212><div class=search-wrapper-content><div class=search-input-body><label for=search-modal-input style=margin-top:-1px><span class=sr-only>search icon</span>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" height="18" width="18" class="search-icon" data-type="search"><path fill="currentcolor" d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8.0 45.3s-32.8 12.5-45.3.0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9.0 208S93.1.0 208 0 416 93.1 416 208zM208 352a144 144 0 100-288 144 144 0 100 288z"/></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" height="18" width="18" class="search-reset" data-type="reset"><path fill="currentcolor" d="M256 512A256 256 0 10256 0a256 256 0 100 512zM175 175c9.4-9.4 24.6-9.4 33.9.0l47 47 47-47c9.4-9.4 24.6-9.4 33.9.0s9.4 24.6.0 33.9l-47 47 47 47c9.4 9.4 9.4 24.6.0 33.9s-24.6 9.4-33.9.0l-47-47-47 47c-9.4 9.4-24.6 9.4-33.9.0s-9.4-24.6.0-33.9l47-47-47-47c-9.4-9.4-9.4-24.6.0-33.9z"/></svg></label><input id=search-modal-input type=text data-search-input autocomplete=off aria-label=Search placeholder="Search Post ..."></div><div class=search-wrapper-body><div class=search-result data-search-result></div><span class=search-result-empty>Type something to search..</span></div><div class=search-wrapper-footer><span><kbd><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentcolor" style="margin-top:-2px" viewBox="0 0 16 16"><path d="M3.204 11h9.592L8 5.519 3.204 11zm-.753-.659 4.796-5.48a1 1 0 011.506.0l4.796 5.48c.566.647.106 1.659-.753 1.659H3.204a1 1 0 01-.753-1.659z"/></svg></kbd><kbd><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentcolor" style="margin-top:1px" viewBox="0 0 16 16"><path d="M3.204 5h9.592L8 10.481 3.204 5zm-.753.659 4.796 5.48a1 1 0 001.506.0l4.796-5.48c.566-.647.106-1.659-.753-1.659H3.204a1 1 0 00-.753 1.659z"/></svg></kbd>to navigate
</span><span><kbd><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentcolor" style="display:inline-block" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M14.5 1.5a.5.5.0 01.5.5v4.8a2.5 2.5.0 01-2.5 2.5H2.707l3.347 3.346a.5.5.0 01-.708.708l-4.2-4.2a.5.5.0 010-.708l4-4a.5.5.0 11.708.708L2.707 8.3H12.5A1.5 1.5.0 0014 6.8V2a.5.5.0 01.5-.5z"/></svg></kbd>to select
</span><span class=search-result-info></span>
<span data-target=close-search-modal><kbd>ESC</kbd> to close</span></div></div></div><main><section class="section pt-7"><div class=container><div class="row justify-center"><article class=lg:col-10><h1 class="h2 mb-4">CompletableFuture</h1><ul class=mb-4><li class="mr-4 inline-block"><i class="fa-regular fa-folder mr-2"></i>
<a href=/categories/java/ class=ms-1>Java</a></li><li class="mr-4 inline-block"><i class="fa-regular fa-clock mr-2"></i>
2021년 12월 8일</li></ul><div class="content mb-10 mt-9"><h2 id=1-java에서의-concurrent>1. Java에서의 Concurrent</h2><blockquote><p>Concurrent 소프트웨어란? 동시에 여러 작업을 할 수 있는 소프트웨어</p></blockquote><ol><li>멀티 프로세싱 ( ProcessBuilder )</li><li>멀티 스레딩 ( Thread/Runnable )</li></ol><h3 id=1-동시성concurrency-vs-병렬성parallelism>1) 동시성(Concurrency) vs 병렬성(Parallelism)</h3><blockquote><p>동시성? 싱글코어에서 멀티 스레드를 동작시키기 위한 방식으로 멀티 태스킹을 위해 여러개 스레드가 번갈아가면서 실행. 한마디로 동시에 실행되는 것처럼 보이는 것.</p><p>멀티스레드로 동시성을 만족시킬수 있는 거지 동시성이 멀티스레드는 아님. 코틀린의 코루틴은 싱글스레드로 동시성을 만족</p></blockquote><blockquote><p>병렬성? 2개이상의 task가 있을때 각 task가 물리적인 시간으로 동시에 실행이 가능. 멀티코어에서 멀티스레드를 동작시키는 방식으로 한개 이상의 스레드를 포함하는 각 작업들이 물리적인 시간으로 완전 동시에 수행하는 것. (이때 동시 작업은 멀티코어가 될수도 네트워크를 이용한 분산컴퓨팅이 될 수 있다.)</p></blockquote><p>병렬성을 만족하면 동시성도 만족, 동시성을 만족한다고 병렬성 만족x</p><br><h3 id=2-자바에서-지원하는-concurrent-프로그래밍>2) 자바에서 지원하는 Concurrent 프로그래밍</h3><ul><li>멀티쓰레드</li><li>멀티프로세싱(ProcessBuilder)</li></ul><table><thead><tr><th style=text-align:center><code>버전</code></th><th style=text-align:center><code>사용 방법</code></th></tr></thead><tbody><tr><td style=text-align:center>Java 5 이전</td><td style=text-align:center>Runnable과 Thread를 이용하여 구현</td></tr><tr><td style=text-align:center>Java 5</td><td style=text-align:center>ExecutorService, Callable, Future</td></tr><tr><td style=text-align:center>Java 7</td><td style=text-align:center>Fork/Join 그리고 RecursiveTask</td></tr><tr><td style=text-align:center>Java 8</td><td style=text-align:center>Stream, CompletableFuture</td></tr><tr><td style=text-align:center>Java 9</td><td style=text-align:center>분산 비동기 프로그래밍은 명시적으로 지원 (발행 구독 프로토콜 지원 Flow API)</td></tr></tbody></table><br><h3 id=3-자바-멀티쓰레드-프로그래밍>3) 자바 멀티쓰레드 프로그래밍</h3><ul><li><p>Thread/Runnable</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#c678dd>public</span> <span style=color:#c678dd>class</span> <span style=color:#e5c07b>App</span> {
</span></span><span style=display:flex><span>    <span style=color:#c678dd>public</span> <span style=color:#c678dd>static</span> <span style=color:#e5c07b>void</span> <span style=color:#61afef;font-weight:700>main</span>(<span style=color:#e06c75>String</span><span style=color:#56b6c2>[]</span> <span style=color:#e06c75>args</span>) {
</span></span><span style=display:flex><span>				<span style=color:#7f848e>// 첫번째 방법</span>
</span></span><span style=display:flex><span>        <span style=color:#e06c75>MyThread</span> <span style=color:#e06c75>myThread</span> <span style=color:#56b6c2>=</span> <span style=color:#c678dd>new</span> <span style=color:#e06c75>MyThread</span>();
</span></span><span style=display:flex><span>        <span style=color:#e06c75>myThread</span>.<span style=color:#e06c75>start</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#7f848e>// Anonymous class</span>
</span></span><span style=display:flex><span>        <span style=color:#e06c75>Thread</span> <span style=color:#e06c75>runnable</span> <span style=color:#56b6c2>=</span> <span style=color:#c678dd>new</span> <span style=color:#e06c75>Thread</span>(<span style=color:#c678dd>new</span> <span style=color:#e06c75>Runnable</span>() {
</span></span><span style=display:flex><span>            <span style=color:#61afef>@Override</span>
</span></span><span style=display:flex><span>            <span style=color:#c678dd>public</span> <span style=color:#e5c07b>void</span> <span style=color:#61afef;font-weight:700>run</span>() {
</span></span><span style=display:flex><span>                <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;Runnable Thread: &#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#7f848e>// Lambda Expression</span>
</span></span><span style=display:flex><span>        <span style=color:#e06c75>Thread</span> <span style=color:#e06c75>lambdaThread</span> <span style=color:#56b6c2>=</span> <span style=color:#c678dd>new</span> <span style=color:#e06c75>Thread</span>(() <span style=color:#56b6c2>-&gt;</span> <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;Lambda Thread:&#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>()));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;Hello: &#34;</span><span style=color:#56b6c2>+</span><span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#7f848e>// Thread 상속</span>
</span></span><span style=display:flex><span>    <span style=color:#c678dd>static</span> <span style=color:#c678dd>class</span> <span style=color:#e5c07b>MyThread</span> <span style=color:#c678dd>extends</span> <span style=color:#e06c75>Thread</span> {
</span></span><span style=display:flex><span>        <span style=color:#61afef>@Override</span>
</span></span><span style=display:flex><span>        <span style=color:#c678dd>public</span> <span style=color:#e5c07b>void</span> <span style=color:#61afef;font-weight:700>run</span>() {
</span></span><span style=display:flex><span>            <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;Thread: &#34;</span><span style=color:#56b6c2>+</span><span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#7f848e>/* 실행결과
</span></span></span><span style=display:flex><span><span style=color:#7f848e>Hello: main
</span></span></span><span style=display:flex><span><span style=color:#7f848e>Thread: Thread-0
</span></span></span><span style=display:flex><span><span style=color:#7f848e>*/</span>
</span></span></code></pre></div><ul><li>코드의 실행 순서만 봐서는 Thread가 먼저 출력되야 할 것 같지만, 실제로 실행해보면 다르게 출력될 때도 있다.</li><li>이를 통해 Thread는 순서를 보장하지 않는다는 것을 알 수 있다.</li></ul></li></ul><p>여기선 로컬클래스를 이용했지만, 익명클래스와 람다표현식을 이용해서도 적용할 수 있다.</p><br><h3 id=4-주요기능method>4) 주요기능(method)</h3><h4 id=sleep_mills_>sleep(<em>mills</em>)</h4><p>현재 쓰레드 재우기(멈춰두기)</p><ul><li>스레드를 대기상태로 멈춰서 다른 스레드가 처리할 수 있도록 함.</li><li>하지만 락을 놔주진 않기에 잘못하면 데드락 상태에 걸릴 수 있다.</li></ul><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#c678dd>public</span> <span style=color:#c678dd>static</span> <span style=color:#e5c07b>void</span> <span style=color:#61afef;font-weight:700>main</span>(<span style=color:#e06c75>String</span><span style=color:#56b6c2>[]</span> <span style=color:#e06c75>args</span>) <span style=color:#c678dd>throws</span> <span style=color:#e06c75>InterruptedException</span> {
</span></span><span style=display:flex><span>    <span style=color:#7f848e>// Lambda Expression</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>Thread</span> <span style=color:#e06c75>lambdaThread</span> <span style=color:#56b6c2>=</span> <span style=color:#c678dd>new</span> <span style=color:#e06c75>Thread</span>(() <span style=color:#56b6c2>-&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#c678dd>try</span> {
</span></span><span style=display:flex><span>            <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>sleep</span>(<span style=color:#e06c75>1000L</span>);
</span></span><span style=display:flex><span>        } <span style=color:#c678dd>catch</span>(<span style=color:#e06c75>InterruptedException</span> <span style=color:#e06c75>e</span>){
</span></span><span style=display:flex><span>            <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;interrupted!&#34;</span>);
</span></span><span style=display:flex><span>            <span style=color:#c678dd>return</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;Thread: &#34;</span><span style=color:#56b6c2>+</span><span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>    <span style=color:#e06c75>lambdaThread</span>.<span style=color:#e06c75>start</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;Hello: &#34;</span><span style=color:#56b6c2>+</span><span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Thread.sleep(1000L)</strong> : Thread를 start하면 1초(1000L)동안 멈춰있고 그 동안 다른 쓰레드를 수행하기 때문에 Hello가 항상 우선 출력된다.</p><br><h4 id=interrupt>interrupt()</h4><p>다른 쓰레드를 깨우기</p><ul><li><strong>InterruptException</strong> 을 발생</li><li>이 에러에 대한 핸들링은 구현 가능</li></ul><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#c678dd>public</span> <span style=color:#c678dd>static</span> <span style=color:#e5c07b>void</span> <span style=color:#61afef;font-weight:700>main</span>(<span style=color:#e06c75>String</span><span style=color:#56b6c2>[]</span> <span style=color:#e06c75>args</span>) <span style=color:#c678dd>throws</span> <span style=color:#e06c75>InterruptedException</span> {
</span></span><span style=display:flex><span>    <span style=color:#7f848e>// Lambda Expression</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>Thread</span> <span style=color:#e06c75>lambdaThread</span> <span style=color:#56b6c2>=</span> <span style=color:#c678dd>new</span> <span style=color:#e06c75>Thread</span>(() <span style=color:#56b6c2>-&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#c678dd>try</span> {
</span></span><span style=display:flex><span>            <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>sleep</span>(<span style=color:#e06c75>3000L</span>);
</span></span><span style=display:flex><span>        } <span style=color:#c678dd>catch</span>(<span style=color:#e06c75>InterruptedException</span> <span style=color:#e06c75>e</span>){
</span></span><span style=display:flex><span>            <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;interrupted!&#34;</span>);
</span></span><span style=display:flex><span>            <span style=color:#c678dd>return</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;Thread: &#34;</span><span style=color:#56b6c2>+</span><span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>    <span style=color:#e06c75>lambdaThread</span>.<span style=color:#e06c75>start</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>lambdaThread</span>.<span style=color:#e06c75>interrupt</span>();
</span></span><span style=display:flex><span>    <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;Hello: &#34;</span><span style=color:#56b6c2>+</span><span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>lambdaThread.interrupt();</strong> : lambdaThread에 interrupt()메소드를 호출해 lambdaThread내에 InterruptedException 을 발생시킨다.</p><br><h4 id=oin>oin()</h4><p>다른 쓰레드가 끝날 때까지 기다린다.</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#c678dd>public</span> <span style=color:#c678dd>static</span> <span style=color:#e5c07b>void</span> <span style=color:#61afef;font-weight:700>main</span>(<span style=color:#e06c75>String</span><span style=color:#56b6c2>[]</span> <span style=color:#e06c75>args</span>) <span style=color:#c678dd>throws</span> <span style=color:#e06c75>InterruptedException</span> {
</span></span><span style=display:flex><span>    <span style=color:#7f848e>//Lambda Expression</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>Thread</span> <span style=color:#e06c75>lambdaThread</span> <span style=color:#56b6c2>=</span> <span style=color:#c678dd>new</span> <span style=color:#e06c75>Thread</span>(() <span style=color:#56b6c2>-&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#c678dd>try</span> {
</span></span><span style=display:flex><span>            <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>sleep</span>(<span style=color:#e06c75>3000L</span>);
</span></span><span style=display:flex><span>        } <span style=color:#c678dd>catch</span>(<span style=color:#e06c75>InterruptedException</span> <span style=color:#e06c75>e</span>){
</span></span><span style=display:flex><span>            <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;interrupted!&#34;</span>);
</span></span><span style=display:flex><span>            <span style=color:#c678dd>return</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;Thread: &#34;</span><span style=color:#56b6c2>+</span><span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>    <span style=color:#e06c75>lambdaThread</span>.<span style=color:#e06c75>start</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>lambdaThread</span>.<span style=color:#e06c75>join</span>();
</span></span><span style=display:flex><span>    <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;Hello: &#34;</span><span style=color:#56b6c2>+</span><span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>lambdaThread.join();</strong> : lambdaThread에 join()메소드를 호출하여 lambdaThread가 종료될 때까지 기다린다.</p><br><br><h2 id=2-executors>2. Executors</h2><blockquote><p>Runnable이나 Thread와 같은 Low-level이 아닌 고 수준(High-Level) Concurrency 프로그래밍</p></blockquote><p>우리가 Runnable만 정의해서 제공해주면 스레드를 만들고, 불필요해지면 종료하고 관리해주는 작업들을 대신 해주는 클래스</p><img title="image title" loading=lazy decoding=async src=https://user-images.githubusercontent.com/42997924/142596222-8710c7ee-3434-4164-a4db-78a443ca8ae3.png alt=alter-text class="img img-fluid img-center
glightbox" width height>
<script>window.addEventListener("load",e=>{const t=GLightbox()})</script><p>고수준의 Concurrency 프로그래밍을 지원하는 라이브러리로 위와 같은 스레드 풀 라이브러리 들을 이용하여 구현되어있다.</p><p>스레드를 만들고 관리하는 작업을 애플리케이션에서 분리하여 Executors에 위임한 형태이다.</p><br><h3 id=1-executors가-하는-일>1) Executors가 하는 일</h3><ul><li>쓰레드 만들기: 애플리케이션이 사용할 쓰레드 풀을 만들어관리한다.</li><li>쓰레드 관리: 쓰레드 생명 주기를 관리한다.</li><li>작업 처리 및 실행: 쓰레드로 실행할 작업을 제공할 수 있는 API를 제공한다.</li></ul><br><h3 id=2-주요-인터페이스>2) 주요 인터페이스</h3><ul><li><strong>Executor</strong>: execute(Runnable)</li><li><strong>ExecutorService</strong>: Executor를 상속 받은 인터페이스로, Callable도 실행 가능하며 Executor를 종료 시키거나 여러 Callable을 동시에 실행하는 등의 기능을 제공한다.</li><li><strong>ScheduledExecutorService</strong>: ExecutorService를 상속 받은 인터페이스로 특정 시간 이후에 또는 주기적으로 작업 실행할 수 있다.</li></ul><br><h3 id=3-예제>3) 예제</h3><h4 id=기본-사용-예제>기본 사용 예제</h4><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#c678dd>public</span> <span style=color:#c678dd>static</span> <span style=color:#e5c07b>void</span> <span style=color:#61afef;font-weight:700>main</span>(<span style=color:#e06c75>String</span><span style=color:#56b6c2>[]</span> <span style=color:#e06c75>args</span>) <span style=color:#c678dd>throws</span> <span style=color:#e06c75>InterruptedException</span> {
</span></span><span style=display:flex><span>		<span style=color:#7f848e>// ExecutorService 생성</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>ExecutorService</span> <span style=color:#e06c75>executorService</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>Executors</span>.<span style=color:#e06c75>newSingleThreadExecutor</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#7f848e>// Legacy case</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>executorService</span>.<span style=color:#e06c75>execute</span>(<span style=color:#c678dd>new</span> <span style=color:#e06c75>Runnable</span>() {
</span></span><span style=display:flex><span>        <span style=color:#61afef>@Override</span>
</span></span><span style=display:flex><span>        <span style=color:#c678dd>public</span> <span style=color:#e5c07b>void</span> <span style=color:#61afef;font-weight:700>run</span>() {
</span></span><span style=display:flex><span>            <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;Thread: &#34;</span><span style=color:#56b6c2>+</span><span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>    <span style=color:#7f848e>// Lambda Expression</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>executorService</span>.<span style=color:#e06c75>submit</span>(()<span style=color:#56b6c2>-&gt;</span>{
</span></span><span style=display:flex><span>        <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;Lambda Expression Thread: &#34;</span><span style=color:#56b6c2>+</span><span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>executorService</span>.<span style=color:#e06c75>shutdown</span>(); <span style=color:#7f848e>// graceful shutdown</span>
</span></span><span style=display:flex><span>    <span style=color:#7f848e>// executorService.shutdownNow(); //즉시 종료</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><br><h4 id=2개의-thread를-이용하여-실행>2개의 Thread를 이용하여 실행</h4><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#c678dd>public</span> <span style=color:#c678dd>class</span> <span style=color:#e5c07b>App</span> {
</span></span><span style=display:flex><span>    <span style=color:#c678dd>private</span> <span style=color:#c678dd>static</span> <span style=color:#e06c75>Runnable</span> <span style=color:#61afef;font-weight:700>getRunnable</span>(<span style=color:#e06c75>String</span> <span style=color:#e06c75>message</span>) {
</span></span><span style=display:flex><span>        <span style=color:#c678dd>return</span> () <span style=color:#56b6c2>-&gt;</span> <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#e06c75>message</span> <span style=color:#56b6c2>+</span> <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#c678dd>public</span> <span style=color:#c678dd>static</span> <span style=color:#e5c07b>void</span> <span style=color:#61afef;font-weight:700>main</span>(<span style=color:#e06c75>String</span><span style=color:#56b6c2>[]</span> <span style=color:#e06c75>args</span>) <span style=color:#c678dd>throws</span> <span style=color:#e06c75>InterruptedException</span> {
</span></span><span style=display:flex><span>        <span style=color:#e06c75>ExecutorService</span> <span style=color:#e06c75>executorService</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>Executors</span>.<span style=color:#e06c75>newFixedThreadPool</span>(<span style=color:#e06c75>2</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#e06c75>executorService</span>.<span style=color:#e06c75>submit</span>(<span style=color:#e06c75>getRunnable</span>(<span style=color:#98c379>&#34;Hello&#34;</span>));
</span></span><span style=display:flex><span>        <span style=color:#e06c75>executorService</span>.<span style=color:#e06c75>submit</span>(<span style=color:#e06c75>getRunnable</span>(<span style=color:#98c379>&#34;World&#34;</span>));
</span></span><span style=display:flex><span>        <span style=color:#e06c75>executorService</span>.<span style=color:#e06c75>submit</span>(<span style=color:#e06c75>getRunnable</span>(<span style=color:#98c379>&#34;The&#34;</span>));
</span></span><span style=display:flex><span>        <span style=color:#e06c75>executorService</span>.<span style=color:#e06c75>submit</span>(<span style=color:#e06c75>getRunnable</span>(<span style=color:#98c379>&#34;Java&#34;</span>));
</span></span><span style=display:flex><span>        <span style=color:#e06c75>executorService</span>.<span style=color:#e06c75>submit</span>(<span style=color:#e06c75>getRunnable</span>(<span style=color:#98c379>&#34;Lecture&#34;</span>));
</span></span><span style=display:flex><span>        <span style=color:#e06c75>executorService</span>.<span style=color:#e06c75>submit</span>(<span style=color:#e06c75>getRunnable</span>(<span style=color:#98c379>&#34;Concurrent&#34;</span>));
</span></span><span style=display:flex><span>        <span style=color:#e06c75>executorService</span>.<span style=color:#e06c75>submit</span>(<span style=color:#e06c75>getRunnable</span>(<span style=color:#98c379>&#34;Part&#34;</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#e06c75>executorService</span>.<span style=color:#e06c75>shutdown</span>(); <span style=color:#7f848e>//graceful shutdown</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#7f848e>/* 실행결과
</span></span></span><span style=display:flex><span><span style=color:#7f848e>Hellopool-1-thread-1
</span></span></span><span style=display:flex><span><span style=color:#7f848e>Worldpool-1-thread-2
</span></span></span><span style=display:flex><span><span style=color:#7f848e>Javapool-1-thread-2
</span></span></span><span style=display:flex><span><span style=color:#7f848e>Thepool-1-thread-1
</span></span></span><span style=display:flex><span><span style=color:#7f848e>Lecturepool-1-thread-2
</span></span></span><span style=display:flex><span><span style=color:#7f848e>Concurrentpool-1-thread-1
</span></span></span><span style=display:flex><span><span style=color:#7f848e>Partpool-1-thread-2
</span></span></span><span style=display:flex><span><span style=color:#7f848e>*/</span>
</span></span></code></pre></div><p><strong>Executors.newFixedThreadPool(2)</strong></p><ul><li>해당 메소드를 호출하면 해당 영역에는 인자값으로 넘겨준 숫자만큼 Thread를 관리한다.</li><li>위 코드에서는 2를 인자값으로 넘겨줬기 때문에 2개의 2개의 쓰레드를 관리하는 Thread Pool이 도는 동안 Blocking Queue에 등록된 작업들이 차례대로 동작한다.</li></ul><img title="image title" loading=lazy decoding=async class="img img-fluid img-center
glightbox" width=720 height=540 src=/images/java/completeableFuture/ExecutorService.gif alt=alter-text onerror='this.onerror="null",this.src=""'><p><strong>ExecutorService.newSingleThreadScheduledExcutor();</strong></p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#e06c75>ScheduledExecutorService</span> <span style=color:#e06c75>executorService</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>Executors</span>.<span style=color:#e06c75>newSingleThreadScheduledExecutor</span>();
</span></span><span style=display:flex><span><span style=color:#e06c75>executorService</span>.<span style=color:#e06c75>scheduleAtFixedRate</span>(<span style=color:#e06c75>getRunnable</span>(<span style=color:#98c379>&#34;hello&#34;</span>), <span style=color:#e06c75>3</span>, <span style=color:#e06c75>1</span>, <span style=color:#e06c75>TimeUnit</span>.<span style=color:#e06c75>SECONDS</span>);
</span></span></code></pre></div><ul><li>scheduleAtFixedRate(실행 Runnable, 시작 지연 시간, 딜레이, 파라미터 시간 단위)</li><li>위 코드는 Runnable타입을 반환하는 getRunnable() 메소드를 프로그램이 시작 후 3초 뒤부터 1초마다 수행하는 코드</li></ul><br><h3 id=4-executor-정리>4) Executor 정리</h3><ul><li><strong>supplyAsync</strong> 등의 메소드 호출시 쓰레드 풀을 명시하지 않으면 <a href=https://kwonnam.pe.kr/wiki/java/concurrent/forkjoinpool target=_blank>Java ForkJoinPool</a>
의 <strong>commonPool()</strong> 이 사용된다.</li><li>개발자가 쓰레드 풀을 제어할 수 없다는 것은 나중에 문제가 될 수 있다.</li><li>따라서, 항상 <a href=https://kwonnam.pe.kr/wiki/java/concurrent/executorservice target=_blank>Java ExecutorService</a>
를 명시적으로 사용하여 쓰레드 풀을 지정하도록 한다.</li></ul><br><br><h2 id=3-callable과-future>3. Callable과 Future</h2><h3 id=1-callable>1) Callable</h3><p>Runnable과 거의 유사하지만 반환 값을 가질 수 있다.</p><br><h3 id=2-future>2) Future</h3><p>비동기적인 작업의 현재 상태를 조회하거나 결과를 가져올 수 있다.</p><br><h3 id=3-메소드-살펴보기>3) 메소드 살펴보기</h3><h4 id=작업-요청-executesubmit>작업 요청 (execute/submit)</h4><ul><li><p>execute : 리턴타입이 void로 작업처리 결과를 리턴받지 못하고 작업처리 도중에 예외가 발생하면 스레드가 종료되고 해당 스레드는 스레드풀에서 제거</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#c678dd>public</span> <span style=color:#e5c07b>void</span> <span style=color:#61afef;font-weight:700>execute</span>(<span style=color:#e06c75>Runnable</span> <span style=color:#e06c75>command</span>) {
</span></span><span style=display:flex><span>    <span style=color:#c678dd>if</span> (<span style=color:#e06c75>command</span> <span style=color:#56b6c2>==</span> <span style=color:#e5c07b>null</span>)
</span></span><span style=display:flex><span>        <span style=color:#c678dd>throw</span> <span style=color:#c678dd>new</span> <span style=color:#e06c75>NullPointerException</span>();
</span></span><span style=display:flex><span>    <span style=color:#e5c07b>int</span> <span style=color:#e06c75>c</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>ctl</span>.<span style=color:#e06c75>get</span>();
</span></span><span style=display:flex><span>    <span style=color:#c678dd>if</span> (<span style=color:#e06c75>workerCountOf</span>(<span style=color:#e06c75>c</span>) <span style=color:#56b6c2>&lt;</span> <span style=color:#e06c75>corePoolSize</span>) {  <span style=color:#7f848e>//현재 생성된 스레드갯수가  코어 개수보다 작다면</span>
</span></span><span style=display:flex><span>        <span style=color:#c678dd>if</span> (<span style=color:#e06c75>addWorker</span>(<span style=color:#e06c75>command</span>, <span style=color:#e5c07b>true</span>))   <span style=color:#7f848e>//새로 스레드를 만들어 task를 처리하고 리턴</span>
</span></span><span style=display:flex><span>            <span style=color:#c678dd>return</span>;
</span></span><span style=display:flex><span>        <span style=color:#e06c75>c</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>ctl</span>.<span style=color:#e06c75>get</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#7f848e>//더이상 처리할 스레드가 없을 경우 워커큐에 task를 넣어주고 리턴</span>
</span></span><span style=display:flex><span>    <span style=color:#7f848e>//스레드 풀이 죽었거나 thread가 없는지 check</span>
</span></span><span style=display:flex><span>    <span style=color:#c678dd>if</span> (<span style=color:#e06c75>isRunning</span>(<span style=color:#e06c75>c</span>) <span style=color:#56b6c2>&amp;&amp;</span> <span style=color:#e06c75>workQueue</span>.<span style=color:#e06c75>offer</span>(<span style=color:#e06c75>command</span>)) {
</span></span><span style=display:flex><span>        <span style=color:#e5c07b>int</span> <span style=color:#e06c75>recheck</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>ctl</span>.<span style=color:#e06c75>get</span>();
</span></span><span style=display:flex><span>        <span style=color:#c678dd>if</span> (<span style=color:#56b6c2>!</span> <span style=color:#e06c75>isRunning</span>(<span style=color:#e06c75>recheck</span>) <span style=color:#56b6c2>&amp;&amp;</span> <span style=color:#e06c75>remove</span>(<span style=color:#e06c75>command</span>))
</span></span><span style=display:flex><span>            <span style=color:#e06c75>reject</span>(<span style=color:#e06c75>command</span>);
</span></span><span style=display:flex><span>        <span style=color:#c678dd>else</span> <span style=color:#c678dd>if</span> (<span style=color:#e06c75>workerCountOf</span>(<span style=color:#e06c75>recheck</span>) <span style=color:#56b6c2>==</span> <span style=color:#e06c75>0</span>)
</span></span><span style=display:flex><span>            <span style=color:#e06c75>addWorker</span>(<span style=color:#e5c07b>null</span>, <span style=color:#e5c07b>false</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#c678dd>else</span> <span style=color:#c678dd>if</span> (<span style=color:#56b6c2>!</span><span style=color:#e06c75>addWorker</span>(<span style=color:#e06c75>command</span>, <span style=color:#e5c07b>false</span>))
</span></span><span style=display:flex><span>        <span style=color:#e06c75>reject</span>(<span style=color:#e06c75>command</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>+) ctl : 스레드풀의 상태 , 조금이라도 더 빠른 계산을 위해 비트로 값을 저장하고 비트 연산을 통해 동작</p><ul><li>workerCount : 현재 스레드 개수<ul><li>Integer.SiZE - 3 만큼의 갯수가 최대 갯수로 약 5억개</li></ul></li><li>runState : 스레드풀의 상태<ul><li>RUNNING : 새로운 TASK를 받고 큐에 집어 넣은 일을 하는 상태</li><li>SHUTDOWN : 새로운 TASK를 받지말고 큐에있는 TASK를 처리<ul><li>RUNNING -> SHUTDOWN : shutdown() 호출시</li></ul></li><li>STOP : 새로운 TASK를 받지 않고 큐에있는 TASK도 처리하지 않은 상태로 현재 진행중인 TASK에 INTERRUPT를 건다.<ul><li>(RUNNING or SHUTDOWM) -> STOP : shutdownNow() 호출시</li></ul></li><li>TIDYING : 모든 TASK는 소멸 되었고, WORKER COUNT는 0. 이 상태로 전이되는 스레드는 terminated() 메서드를 실행시켜 종료할 예정인 상태<ul><li>STOP -> TIDYING : 스레드 풀이 비었을때</li></ul></li><li>TERMINATED : 모든 스레드가 terminated()된 상태</li></ul></li></ul></li><li><p>submit : Future타입을 반환하고 작업처리 도중에 예외가 발생해도 스레드는 종료되지 않고 다음 작업을 위해 재사용되기 때문에 스레드의 생성 오버헤더를 줄일 수 있다.</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#c678dd>public</span> <span style=color:#e06c75>Future</span><span style=color:#56b6c2>&lt;?&gt;</span> <span style=color:#e06c75>submit</span>(<span style=color:#e06c75>Runnable</span> <span style=color:#e06c75>task</span>) {
</span></span><span style=display:flex><span>      <span style=color:#c678dd>if</span> (<span style=color:#e06c75>task</span> <span style=color:#56b6c2>==</span> <span style=color:#e5c07b>null</span>) <span style=color:#c678dd>throw</span> <span style=color:#c678dd>new</span> <span style=color:#e06c75>NullPointerException</span>();
</span></span><span style=display:flex><span>      <span style=color:#e06c75>RunnableFuture</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>Void</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>ftask</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>newTaskFor</span>(<span style=color:#e06c75>task</span>, <span style=color:#e5c07b>null</span>);
</span></span><span style=display:flex><span>      <span style=color:#e06c75>execute</span>(<span style=color:#e06c75>ftask</span>);
</span></span><span style=display:flex><span>      <span style=color:#c678dd>return</span> <span style=color:#e06c75>ftask</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></li></ul><br><h4 id=결과-반환--get>결과 반환 : get()</h4><ul><li>해당 메소드는 <strong>블록킹 콜</strong>이기에 메소드 호출시점부터 코드실행 완료까지 기다린다.</li><li>타임아웃을 설정할 수 있다.</li></ul><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#e06c75>ExecutorService</span> <span style=color:#e06c75>executorService</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>Executors</span>.<span style=color:#e06c75>newSingleThreadExecutor</span>();
</span></span><span style=display:flex><span><span style=color:#e06c75>Callable</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>hello</span> <span style=color:#56b6c2>=</span> () <span style=color:#56b6c2>-&gt;</span>{
</span></span><span style=display:flex><span>    <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>sleep</span>(<span style=color:#e06c75>2000L</span>);
</span></span><span style=display:flex><span>    <span style=color:#c678dd>return</span> <span style=color:#98c379>&#34;Hello&#34;</span>;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span><span style=color:#e06c75>Future</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>submit</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>executorService</span>.<span style=color:#e06c75>submit</span>(<span style=color:#e06c75>hello</span>);
</span></span><span style=display:flex><span><span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;Started!&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>submit</span>.<span style=color:#e06c75>get</span>();<span style=color:#7f848e>// blocking</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;End&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#e06c75>executorService</span>.<span style=color:#e06c75>shutdown</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#7f848e>/*
</span></span></span><span style=display:flex><span><span style=color:#7f848e>Started!
</span></span></span><span style=display:flex><span><span style=color:#7f848e>(2초 뒤)
</span></span></span><span style=display:flex><span><span style=color:#7f848e>End
</span></span></span><span style=display:flex><span><span style=color:#7f848e>*/</span>
</span></span></code></pre></div><br><h4 id=작업-상태-확인---isdone>작업 상태 확인 - isDone()</h4><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#e06c75>ExecutorService</span> <span style=color:#e06c75>executorService</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>Executors</span>.<span style=color:#e06c75>newSingleThreadExecutor</span>();
</span></span><span style=display:flex><span><span style=color:#e06c75>Callable</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>hello</span> <span style=color:#56b6c2>=</span> () <span style=color:#56b6c2>-&gt;</span>{
</span></span><span style=display:flex><span>    <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>sleep</span>(<span style=color:#e06c75>2000L</span>);
</span></span><span style=display:flex><span>    <span style=color:#c678dd>return</span> <span style=color:#98c379>&#34;Hello&#34;</span>;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span><span style=color:#e06c75>Future</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>helloFuture</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>executorService</span>.<span style=color:#e06c75>submit</span>(<span style=color:#e06c75>hello</span>);
</span></span><span style=display:flex><span><span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#e06c75>helloFuture</span>.<span style=color:#e06c75>isDone</span>());
</span></span><span style=display:flex><span><span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;Started!&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>helloFuture</span>.<span style=color:#e06c75>get</span>(); <span style=color:#7f848e>// blocking</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#e06c75>helloFuture</span>.<span style=color:#e06c75>isDone</span>());
</span></span><span style=display:flex><span><span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;End&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#e06c75>executorService</span>.<span style=color:#e06c75>shutdown</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#7f848e>/* 실행 결과
</span></span></span><span style=display:flex><span><span style=color:#7f848e>false
</span></span></span><span style=display:flex><span><span style=color:#7f848e>Started!
</span></span></span><span style=display:flex><span><span style=color:#7f848e>true
</span></span></span><span style=display:flex><span><span style=color:#7f848e>End
</span></span></span><span style=display:flex><span><span style=color:#7f848e>*/</span>
</span></span></code></pre></div><br><h4 id=작업-취소--cancel>작업 취소 : cancel()</h4><ul><li>인자 값으로 현재 진행중인 쓰레드 interrupt 여부를 결정한다.</li><li>true 이면 현재 진행중인 쓰레드를 interrupt하고 그렇지 않으면 현재 진행중인 작업이 끝날때까지 기다린다.</li></ul><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#e06c75>ExecutorService</span> <span style=color:#e06c75>executorService</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>Executors</span>.<span style=color:#e06c75>newSingleThreadExecutor</span>();
</span></span><span style=display:flex><span><span style=color:#e06c75>Callable</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>hello</span> <span style=color:#56b6c2>=</span> () <span style=color:#56b6c2>-&gt;</span>{
</span></span><span style=display:flex><span>    <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>sleep</span>(<span style=color:#e06c75>2000L</span>);
</span></span><span style=display:flex><span>    <span style=color:#c678dd>return</span> <span style=color:#98c379>&#34;Hello&#34;</span>;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span><span style=color:#e06c75>Future</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>helloFuture</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>executorService</span>.<span style=color:#e06c75>submit</span>(<span style=color:#e06c75>hello</span>);
</span></span><span style=display:flex><span><span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#e06c75>helloFuture</span>.<span style=color:#e06c75>isDone</span>());
</span></span><span style=display:flex><span><span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;Started!&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>helloFuture</span>.<span style=color:#e06c75>cancel</span>(<span style=color:#e5c07b>false</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#e06c75>helloFuture</span>.<span style=color:#e06c75>isDone</span>());
</span></span><span style=display:flex><span><span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;End&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>helloFuture</span>.<span style=color:#e06c75>get</span>();
</span></span><span style=display:flex><span><span style=color:#e06c75>executorService</span>.<span style=color:#e06c75>shutdown</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#7f848e>/* 실행 결과
</span></span></span><span style=display:flex><span><span style=color:#7f848e>false
</span></span></span><span style=display:flex><span><span style=color:#7f848e>Started!
</span></span></span><span style=display:flex><span><span style=color:#7f848e>true
</span></span></span><span style=display:flex><span><span style=color:#7f848e>End
</span></span></span><span style=display:flex><span><span style=color:#7f848e>Exception in thread &#34;main&#34; java.util.concurrent.CancellationException...
</span></span></span><span style=display:flex><span><span style=color:#7f848e>*/</span>
</span></span></code></pre></div><p><strong>helloFuture.cancel(false)</strong></p><ul><li>현재 진행중인 작업을 기다린 뒤 작업을 취소한다.</li><li>작업이 취소되어 종료되었기 때문에 아래에 <strong>helloFuture.isDone()</strong> 은 true가 반환되며, 이미 취소한 작업을 get() 호출하는 시점에는 <strong>CancellationException</strong> 예외가 발생</li></ul><br><h4 id=여러-작업-동시-실행--invokeall>여러 작업 동시 실행 : invokeAll()</h4><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#e06c75>ExecutorService</span> <span style=color:#e06c75>executorService</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>Executors</span>.<span style=color:#e06c75>newSingleThreadExecutor</span>();
</span></span><span style=display:flex><span><span style=color:#e06c75>LocalDateTime</span> <span style=color:#e06c75>start</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>LocalDateTime</span>.<span style=color:#e06c75>now</span>();
</span></span><span style=display:flex><span><span style=color:#e06c75>Callable</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>hello</span> <span style=color:#56b6c2>=</span> () <span style=color:#56b6c2>-&gt;</span>{
</span></span><span style=display:flex><span>    <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>sleep</span>(<span style=color:#e06c75>2000L</span>);
</span></span><span style=display:flex><span>    <span style=color:#c678dd>return</span> <span style=color:#98c379>&#34;Hello&#34;</span>;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span><span style=color:#e06c75>Callable</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>java</span> <span style=color:#56b6c2>=</span> () <span style=color:#56b6c2>-&gt;</span>{
</span></span><span style=display:flex><span>    <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>sleep</span>(<span style=color:#e06c75>3000L</span>);
</span></span><span style=display:flex><span>    <span style=color:#c678dd>return</span> <span style=color:#98c379>&#34;java&#34;</span>;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span><span style=color:#e06c75>Callable</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>youngjun</span> <span style=color:#56b6c2>=</span> () <span style=color:#56b6c2>-&gt;</span>{
</span></span><span style=display:flex><span>    <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>sleep</span>(<span style=color:#e06c75>1000L</span>);
</span></span><span style=display:flex><span>    <span style=color:#c678dd>return</span> <span style=color:#98c379>&#34;youngjun&#34;</span>;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>List</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>Future</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;&gt;</span> <span style=color:#e06c75>futures</span> <span style=color:#56b6c2>=</span>
</span></span><span style=display:flex><span>        <span style=color:#e06c75>executorService</span>.<span style=color:#e06c75>invokeAll</span>(<span style=color:#e06c75>Arrays</span>.<span style=color:#e06c75>asList</span>(<span style=color:#e06c75>hello</span>, <span style=color:#e06c75>java</span>, <span style=color:#e06c75>youngjun</span>));
</span></span><span style=display:flex><span><span style=color:#c678dd>for</span> (<span style=color:#e06c75>Future</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>future</span> : <span style=color:#e06c75>futures</span>) {
</span></span><span style=display:flex><span>    <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#e06c75>future</span>.<span style=color:#e06c75>get</span>());
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#e06c75>LocalDateTime</span> <span style=color:#e06c75>end</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>LocalDateTime</span>.<span style=color:#e06c75>now</span>();
</span></span><span style=display:flex><span><span style=color:#e06c75>Duration</span> <span style=color:#e06c75>between</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>Duration</span>.<span style=color:#e06c75>between</span>(<span style=color:#e06c75>start</span>, <span style=color:#e06c75>end</span>);
</span></span><span style=display:flex><span><span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#e06c75>between</span>.<span style=color:#e06c75>getSeconds</span>());
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#7f848e>/*
</span></span></span><span style=display:flex><span><span style=color:#7f848e>Hello
</span></span></span><span style=display:flex><span><span style=color:#7f848e>java
</span></span></span><span style=display:flex><span><span style=color:#7f848e>youngjun
</span></span></span><span style=display:flex><span><span style=color:#7f848e>6
</span></span></span><span style=display:flex><span><span style=color:#7f848e>*/</span>
</span></span></code></pre></div><ul><li><p>invokeAll() 메소드는 태스크가 모두 끝날때까지 기다렸다가 값들을 반환</p><ul><li>싱글 쓰레드이기 때문에 6초가 소요된다.</li><li>future list를 반환하고 <strong>전부 끝날때까지 holding된다.</strong></li><li>넘겨준 Callable list가 정상 처리되든 exception이 발생하든 완료된 것으로 본다.</li><li>동작중에 전달받은 list가 변경되면 결과를 보장하지 않는다</li><li>넘겨준 list 순서대로 결과 future를 담아서 넘겨준다.</li></ul><p><strong>발생할 수 있는 Exception</strong></p><ul><li><em>InterruptedException</em> : 동작이 종료되지 않은(동작중인) task가 취소 되었을 때</li><li><em>NullPointerException</em> : 함수의 param중 null이 있을 때</li><li><em>RejectedExecutionException</em> : task를 pool에 넣을수 없을 때.</li></ul></li><li><p>따라서 가장 먼저 완료된 작업만 반환해도 괜찮다면 invokeAll을 쓰기에는 성능이 떨어진다.</p><ul><li>그럴 때 사용 할 수 있는 메소드가 invokeAny 이다.</li></ul></li></ul><br><h4 id=여러-작업-동시-실행--invokeany>여러 작업 동시 실행 : invokeAny()</h4><ul><li>동시에 실행한 작업 중에 제일 짧게 걸리는 작업 만큼 시간이 걸린다.</li><li><strong>블록킹 콜</strong>이다.</li></ul><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#e06c75>String</span> <span style=color:#e06c75>result</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>executorService</span>.<span style=color:#e06c75>invokeAny</span>(<span style=color:#e06c75>Arrays</span>.<span style=color:#e06c75>asList</span>(<span style=color:#e06c75>hello</span>, <span style=color:#e06c75>java</span>, <span style=color:#e06c75>youngjun</span>));
</span></span><span style=display:flex><span><span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;result = &#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e06c75>result</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#7f848e>/* 실행 결과
</span></span></span><span style=display:flex><span><span style=color:#7f848e>result = youngjun
</span></span></span><span style=display:flex><span><span style=color:#7f848e>*/</span>
</span></span></code></pre></div><div class="notice warning"><div class=notice-head><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fillRule="evenodd" clipRule="evenodd" d="M10 0c5.522.0 10 4.478 10 10S15.522 20 10 20 0 15.522.0 10 4.478.0 10 0zm0 2C5.589 2 2 5.589 2 10s3.589 8 8 8 8-3.589 8-8-3.589-8-8-8zm2.293 4.293 1.414 1.414L11.414 10l2.293 2.293-1.414 1.414L10 11.414 7.707 13.707 6.293 12.293 8.586 10 6.293 7.707 7.707 6.293 10 8.586l2.293-2.293z" fill="currentcolor"/></svg><p>Warning</p></div><div class=notice-body><p>주의할 점은, 싱글 쓰레드로 할 경우 먼저 들어간 순서대로 나오게 된다는 점이다.</p></div></div><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#c678dd>public</span> <span style=color:#c678dd>static</span> <span style=color:#e5c07b>void</span> <span style=color:#61afef;font-weight:700>main</span>(<span style=color:#e06c75>String</span><span style=color:#56b6c2>[]</span> <span style=color:#e06c75>args</span>) <span style=color:#c678dd>throws</span> <span style=color:#e06c75>InterruptedException</span>, <span style=color:#e06c75>ExecutionException</span> {
</span></span><span style=display:flex><span>    <span style=color:#e06c75>ExecutorService</span> <span style=color:#e06c75>executorService</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>Executors</span>.<span style=color:#e06c75>newSingleThreadExecutor</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>Callable</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>hello</span> <span style=color:#56b6c2>=</span> () <span style=color:#56b6c2>-&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>sleep</span>(<span style=color:#e06c75>2000L</span>);
</span></span><span style=display:flex><span>        <span style=color:#c678dd>return</span> <span style=color:#98c379>&#34;Hello&#34;</span>;
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>Callable</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>java</span> <span style=color:#56b6c2>=</span> () <span style=color:#56b6c2>-&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>sleep</span>(<span style=color:#e06c75>3000L</span>);
</span></span><span style=display:flex><span>        <span style=color:#c678dd>return</span> <span style=color:#98c379>&#34;java&#34;</span>;
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>Callable</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>youngjun</span> <span style=color:#56b6c2>=</span> () <span style=color:#56b6c2>-&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>sleep</span>(<span style=color:#e06c75>1000L</span>);
</span></span><span style=display:flex><span>        <span style=color:#c678dd>return</span> <span style=color:#98c379>&#34;youngjun&#34;</span>;
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>String</span> <span style=color:#e06c75>s</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>executorService</span>.<span style=color:#e06c75>invokeAny</span>(<span style=color:#e06c75>Arrays</span>.<span style=color:#e06c75>asList</span>(<span style=color:#e06c75>hello</span>, <span style=color:#e06c75>java</span>, <span style=color:#e06c75>youngjun</span>));
</span></span><span style=display:flex><span>    <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#e06c75>s</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>executorService</span>.<span style=color:#e06c75>shutdown</span>();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#7f848e>/* 실행 결과
</span></span></span><span style=display:flex><span><span style=color:#7f848e>Hello
</span></span></span><span style=display:flex><span><span style=color:#7f848e>*/</span>
</span></span></code></pre></div><br><br><h2 id=4-completablefuture>4. CompletableFuture</h2><h3 id=1-개요>1) 개요</h3><p>자바에서 비동기(Asynchronous)프로그래밍을 가능하게하는 인터페이스.</p><p>Future의 제약사항들을 해결한다.</p><br><h3 id=2-future-제약>2) Future 제약</h3><ul><li><p>예외 처리용 API를 제공하지 않는다.</p></li><li><p>여러 Future를 조합할 수 없다. (ex: Event정보를 받아 다음 Event에 참석할 회원목록조회)</p></li><li><p>Future를 외부에서 완료시킬 수 없다. 취소하거나, get()에 타임아웃을 설정할 수는 있다.</p></li><li><p>get()을 호출하기 전까지는 future를 다룰 수 없다.</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#e06c75>ExecutorService</span> <span style=color:#e06c75>executorService</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>Executors</span>.<span style=color:#e06c75>newFixedThreadPool</span>(<span style=color:#e06c75>4</span>);
</span></span><span style=display:flex><span><span style=color:#e06c75>Future</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>future</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>executorService</span>.<span style=color:#e06c75>submit</span>(() <span style=color:#56b6c2>-&gt;</span> <span style=color:#98c379>&#34;hello&#34;</span>);
</span></span><span style=display:flex><span>...<span style=color:#7f848e>//TODO</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>future</span>.<span style=color:#e06c75>get</span>();
</span></span><span style=display:flex><span>...<span style=color:#7f848e>//TODO</span>
</span></span></code></pre></div></li><li><p>여기서 future는 blocking call</p></li></ul><p>future를 get()으로 가져오는 동안에는 다른 작업들의 수행이 안된다는 의미이고 그 기간이 길어질수록 성능은 떨어질수 밖에 없다.</p><br><h3 id=3-completablefuture>3) CompletableFuture</h3><p>Future와 CompletionStage를 구현하는 구현체</p><ul><li><p>예외처리를 지원하는 메서드</p></li><li><p>순서의 의존관계를 맞는 스레드 프로그래밍</p></li><li><p>콜백을 지원하기도 하며 여러 스레드를 하나로 묶어 처리하기에도 용이</p><p><em>public class CompletableFuture<t> implements Future<t>, CompletionStage<t>{&mldr;}</em></p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#e06c75>CompletableFuture</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>future</span> <span style=color:#56b6c2>=</span> <span style=color:#c678dd>new</span> <span style=color:#e06c75>CompletableFuture</span><span style=color:#56b6c2>&lt;&gt;</span>();
</span></span><span style=display:flex><span><span style=color:#e06c75>future</span>.<span style=color:#e06c75>complete</span>(<span style=color:#98c379>&#34;youngjun&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;future = &#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e06c75>future</span>.<span style=color:#e06c75>get</span>());
</span></span><span style=display:flex><span><span style=color:#7f848e>//-------------OR --------------</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>CompletableFuture</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>future</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>CompletableFuture</span>.<span style=color:#e06c75>completedFuture</span>(<span style=color:#98c379>&#34;youngjun&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;future = &#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e06c75>future</span>.<span style=color:#e06c75>get</span>());
</span></span></code></pre></div></li></ul><br><h3 id=4-비동기로-작업-실행하기>4) 비동기로 작업 실행하기</h3><ul><li><p>리턴값이 없는 경우: <strong>runAsync()</strong></p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#e06c75>CompletableFuture</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>Void</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>future</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>CompletableFuture</span>.<span style=color:#e06c75>runAsync</span>(() <span style=color:#56b6c2>-&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;Hello&#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span><span style=color:#e06c75>future</span>.<span style=color:#e06c75>get</span>();
</span></span></code></pre></div></li><li><p>리턴값이 있는 경우: <strong>supplyAsync()</strong></p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#e06c75>CompletableFuture</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>future</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>CompletableFuture</span>.<span style=color:#e06c75>supplyAsync</span>(() <span style=color:#56b6c2>-&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;Hello&#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>    <span style=color:#c678dd>return</span> <span style=color:#98c379>&#34;Hello&#34;</span>;
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span><span style=color:#e06c75>future</span>.<span style=color:#e06c75>get</span>();
</span></span></code></pre></div></li><li><p>원하는 <strong>Executor</strong>(쓰레드풀)를 사용해서 실행할 수도 있다. (기본은 <strong>ForkJoinPool.commonPool()</strong>)</p></li></ul><br><h3 id=5-콜백-제공하기>5) 콜백 제공하기</h3><ul><li><p><em>thenApply(Function)</em> : 리턴값을 받아서 다른 값으로 바꾸는 콜백</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#e06c75>CompletableFuture</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>future</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>CompletableFuture</span>.<span style=color:#e06c75>supplyAsync</span>(() <span style=color:#56b6c2>-&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;Hello&#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>  <span style=color:#c678dd>return</span> <span style=color:#98c379>&#34;Hello&#34;</span>;
</span></span><span style=display:flex><span>}).<span style=color:#e06c75>thenApply</span>((<span style=color:#e06c75>s</span>)<span style=color:#56b6c2>-&gt;</span>{
</span></span><span style=display:flex><span>  <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;content: &#34;</span><span style=color:#56b6c2>+</span><span style=color:#e06c75>s</span>);
</span></span><span style=display:flex><span>  <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>  <span style=color:#c678dd>return</span> <span style=color:#98c379>&#34;HelloAsync&#34;</span>;
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span><span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#e06c75>future</span>.<span style=color:#e06c75>get</span>());
</span></span></code></pre></div><ul><li>Javascript의 Promise 와 유사한 형태</li><li>supplyAsync의 람다표현식에서 반환된 Hello라는 값은 체이닝된 메소드 thenApply의 인자값으로 들어가고 사용 가능</li><li>그리고 더 이상 체이닝된 메소드가 없기 때문에 return값인 HelloAsync는 반환되어 future로 들어가고 get()을통해 받을 수 있다.</li></ul></li><li><p><em>thenAccept(Consumer)</em> : 리턴값을 받아 또 다른 작업을 수행하는데 반환값은 없는 콜백 (리턴 x)</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#e06c75>CompletableFuture</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>Void</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>future</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>CompletableFuture</span>.<span style=color:#e06c75>supplyAsync</span>(() <span style=color:#56b6c2>-&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;Hello&#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>  <span style=color:#c678dd>return</span> <span style=color:#98c379>&#34;Hello&#34;</span>;
</span></span><span style=display:flex><span>}).<span style=color:#e06c75>thenAccept</span>((<span style=color:#e06c75>s</span>)<span style=color:#56b6c2>-&gt;</span>{
</span></span><span style=display:flex><span>  <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;content: &#34;</span><span style=color:#56b6c2>+</span><span style=color:#e06c75>s</span>);
</span></span><span style=display:flex><span>  <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>      <span style=color:#7f848e>// return 없다.</span>
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span><span style=color:#e06c75>future</span>.<span style=color:#e06c75>get</span>();
</span></span></code></pre></div></li><li><p><em>thenRun(Runnable)</em> : 리턴값을 받지 않고 다른 작업을 수행하는 콜백</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#e06c75>CompletableFuture</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>Void</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>future</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>CompletableFuture</span>.<span style=color:#e06c75>supplyAsync</span>(() <span style=color:#56b6c2>-&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;Hello&#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>  <span style=color:#c678dd>return</span> <span style=color:#98c379>&#34;hello&#34;</span>;
</span></span><span style=display:flex><span>}).<span style=color:#e06c75>thenRun</span>(()<span style=color:#56b6c2>-&gt;</span>{
</span></span><span style=display:flex><span>  <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span><span style=color:#e06c75>future</span>.<span style=color:#e06c75>get</span>();
</span></span></code></pre></div></li></ul><br><h4 id=_parallelstream-vs-completablefuture_><em>ParallelStream vs. CompletableFuture</em></h4><p><a href=https://www.manning.com/books/java-8-in-action target=_blank>Java 8 in Action</a>
에 설명이 되어있다.</p><p><strong>ParallelStream</strong> : <strong>I/O가 포함되지 않은 계산 중심</strong>의 동작을 실행할 때는 스트림 인터페이스가 가장 구현하기 간다하며 효율적일 수 있다(모든 스레드가 계산 작업을 수행하는 상황에서는 프로세서 코어 수 이상의 쓰레드를 가질 필요가 없다).</p><p><strong>CompletableFuture</strong> : 반면 작업이 <strong>I/O를 기다리는 작업을 병렬로 실행</strong>할 때는 CompletableFuture가 더 많은 유연성을 제공하며 대기/계산(W/C)의 비율에 적합한 스레드 수를 설정할 수 있다. 특히 스트림의 게으른 특성 때문에 스트림에서 I/O를 실제로 언제 처리할 지 예측하기 어려운 문제도 있다.
<a href=http://fahdshariff.blogspot.kr/2016/06/java-8-completablefuture-vs-parallel.html target=_blank>fahd.blog: Java 8: CompletableFuture vs Parallel Stream</a></p><br><h3 id=6-completablefuture-조합-메소드>6) CompletableFuture 조합 메소드</h3><h4 id=thencompose>thenCompose()</h4><p>두 작업이 서로 이어서 실행하도록 조합하며 연관된 future간에 많이 사용</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#c678dd>public</span> <span style=color:#c678dd>class</span> <span style=color:#e5c07b>App</span> {
</span></span><span style=display:flex><span>    <span style=color:#c678dd>public</span> <span style=color:#c678dd>static</span> <span style=color:#e5c07b>void</span> <span style=color:#61afef;font-weight:700>main</span>(<span style=color:#e06c75>String</span><span style=color:#56b6c2>[]</span> <span style=color:#e06c75>args</span>) <span style=color:#c678dd>throws</span> <span style=color:#e06c75>InterruptedException</span>, <span style=color:#e06c75>ExecutionException</span> {
</span></span><span style=display:flex><span>        <span style=color:#e06c75>CompletableFuture</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>helloFuture</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>CompletableFuture</span>.<span style=color:#e06c75>supplyAsync</span>(() <span style=color:#56b6c2>-&gt;</span> {
</span></span><span style=display:flex><span>            <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;Hello &#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>            <span style=color:#c678dd>return</span> <span style=color:#98c379>&#34;Hello&#34;</span>;
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#e06c75>CompletableFuture</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>future</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>helloFuture</span>.<span style=color:#e06c75>thenCompose</span>(<span style=color:#e06c75>App</span>::<span style=color:#e06c75>getWorldFuture</span>);
</span></span><span style=display:flex><span>        <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#e06c75>future</span>.<span style=color:#e06c75>get</span>());
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#c678dd>private</span> <span style=color:#c678dd>static</span> <span style=color:#e06c75>CompletableFuture</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#61afef;font-weight:700>getWorldFuture</span>(<span style=color:#e06c75>String</span> <span style=color:#e06c75>message</span>) {
</span></span><span style=display:flex><span>        <span style=color:#c678dd>return</span> <span style=color:#e06c75>CompletableFuture</span>.<span style=color:#e06c75>supplyAsync</span>(() <span style=color:#56b6c2>-&gt;</span> {
</span></span><span style=display:flex><span>            <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;World &#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>            <span style=color:#c678dd>return</span> <span style=color:#e06c75>message</span> <span style=color:#56b6c2>+</span> <span style=color:#98c379>&#34; World&#34;</span>;
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#7f848e>/*
</span></span></span><span style=display:flex><span><span style=color:#7f848e>Hello ForkJoinPool.commonPool-worker-3
</span></span></span><span style=display:flex><span><span style=color:#7f848e>World ForkJoinPool.commonPool-worker-5
</span></span></span><span style=display:flex><span><span style=color:#7f848e>Hello World
</span></span></span><span style=display:flex><span><span style=color:#7f848e>*/</span>
</span></span></code></pre></div><br><h4 id=thencombine>thenCombine()</h4><p>두 작업을 독립적으로 실행하고 둘 다 종료 했을때 콜백 실행.</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#c678dd>public</span> <span style=color:#c678dd>static</span> <span style=color:#e5c07b>void</span> <span style=color:#61afef;font-weight:700>main</span>(<span style=color:#e06c75>String</span><span style=color:#56b6c2>[]</span> <span style=color:#e06c75>args</span>) <span style=color:#c678dd>throws</span> <span style=color:#e06c75>InterruptedException</span>, <span style=color:#e06c75>ExecutionException</span> {
</span></span><span style=display:flex><span>    <span style=color:#e06c75>CompletableFuture</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>msFuture</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>CompletableFuture</span>.<span style=color:#e06c75>supplyAsync</span>(() <span style=color:#56b6c2>-&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;MicroSoft &#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>        <span style=color:#c678dd>return</span> <span style=color:#98c379>&#34;MicroSoft&#34;</span>;
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>CompletableFuture</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>appleFuture</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>CompletableFuture</span>.<span style=color:#e06c75>supplyAsync</span>(() <span style=color:#56b6c2>-&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;Apple &#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>        <span style=color:#c678dd>return</span> <span style=color:#98c379>&#34;Apple&#34;</span>;
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>CompletableFuture</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>resultFuture</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>msFuture</span>.<span style=color:#e06c75>thenCombine</span>(<span style=color:#e06c75>appleFuture</span>, (<span style=color:#e06c75>i</span>, <span style=color:#e06c75>j</span>) <span style=color:#56b6c2>-&gt;</span> <span style=color:#e06c75>i</span> <span style=color:#56b6c2>+</span> <span style=color:#98c379>&#34; &#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e06c75>j</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#e06c75>resultFuture</span>.<span style=color:#e06c75>get</span>());
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h4 id=allof>allOf()</h4><p>여러 작업을 모두 실행하고 모든 작업 결과에 콜백 실행</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#c678dd>public</span> <span style=color:#c678dd>static</span> <span style=color:#e5c07b>void</span> <span style=color:#61afef;font-weight:700>main</span>(<span style=color:#e06c75>String</span><span style=color:#56b6c2>[]</span> <span style=color:#e06c75>args</span>) <span style=color:#c678dd>throws</span> <span style=color:#e06c75>InterruptedException</span>, <span style=color:#e06c75>ExecutionException</span> {
</span></span><span style=display:flex><span>    <span style=color:#e06c75>CompletableFuture</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>msFuture</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>CompletableFuture</span>.<span style=color:#e06c75>supplyAsync</span>(() <span style=color:#56b6c2>-&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;MicroSoft &#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>        <span style=color:#c678dd>return</span> <span style=color:#98c379>&#34;MicroSoft&#34;</span>;
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>CompletableFuture</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>appleFuture</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>CompletableFuture</span>.<span style=color:#e06c75>supplyAsync</span>(() <span style=color:#56b6c2>-&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;Apple &#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>        <span style=color:#c678dd>return</span> <span style=color:#98c379>&#34;Apple&#34;</span>;
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>    <span style=color:#e06c75>List</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>CompletableFuture</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;&gt;</span> <span style=color:#e06c75>futures</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>Arrays</span>.<span style=color:#e06c75>asList</span>(<span style=color:#e06c75>msFuture</span>, <span style=color:#e06c75>appleFuture</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>CompletableFuture</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>List</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;&gt;</span> <span style=color:#e06c75>results</span> <span style=color:#56b6c2>=</span>
</span></span><span style=display:flex><span>            <span style=color:#e06c75>CompletableFuture</span>.<span style=color:#e06c75>allOf</span>(<span style=color:#e06c75>futures</span>.<span style=color:#e06c75>toArray</span>(<span style=color:#c678dd>new</span> <span style=color:#e06c75>CompletableFuture</span><span style=color:#56b6c2>[</span><span style=color:#e06c75>futures</span>.<span style=color:#e06c75>size</span>()<span style=color:#56b6c2>]</span>))
</span></span><span style=display:flex><span>                    .<span style=color:#e06c75>thenApply</span>(<span style=color:#e06c75>v</span> <span style=color:#56b6c2>-&gt;</span> <span style=color:#e06c75>futures</span>.<span style=color:#e06c75>stream</span>()
</span></span><span style=display:flex><span>                            .<span style=color:#e06c75>map</span>(<span style=color:#e06c75>CompletableFuture</span>::<span style=color:#e06c75>join</span>)
</span></span><span style=display:flex><span>                            .<span style=color:#e06c75>collect</span>(<span style=color:#e06c75>Collectors</span>.<span style=color:#e06c75>toList</span>()));
</span></span><span style=display:flex><span>    <span style=color:#e06c75>results</span>.<span style=color:#e06c75>get</span>().<span style=color:#e06c75>forEach</span>(<span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>::<span style=color:#e06c75>println</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><br><h4 id=anyof>anyOf()</h4><p>여러 작업 중 가장 끝난 하나의 결과를 콜백에 넘겨 실행</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#e06c75>CompletableFuture</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>msFuture</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>CompletableFuture</span>.<span style=color:#e06c75>supplyAsync</span>(() <span style=color:#56b6c2>-&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;MicroSoft &#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>    <span style=color:#c678dd>return</span> <span style=color:#98c379>&#34;MicroSoft&#34;</span>;
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>CompletableFuture</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>appleFuture</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>CompletableFuture</span>.<span style=color:#e06c75>supplyAsync</span>(() <span style=color:#56b6c2>-&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;Apple &#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>    <span style=color:#c678dd>return</span> <span style=color:#98c379>&#34;Apple&#34;</span>;
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>CompletableFuture</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>Void</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>future</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>CompletableFuture</span>.<span style=color:#e06c75>anyOf</span>(<span style=color:#e06c75>msFuture</span>, <span style=color:#e06c75>appleFuture</span>).<span style=color:#e06c75>thenAccept</span>(<span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>::<span style=color:#e06c75>println</span>);
</span></span><span style=display:flex><span><span style=color:#e06c75>future</span>.<span style=color:#e06c75>get</span>();
</span></span></code></pre></div><br><h3 id=7-예외-처리-메소드>7) 예외 처리 메소드</h3><h4 id=exeptionallyfunction>exeptionally(Function)</h4><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#e5c07b>boolean</span> <span style=color:#e06c75>throwError</span> <span style=color:#56b6c2>=</span> <span style=color:#e5c07b>true</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>CompletableFuture</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>msFuture</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>CompletableFuture</span>.<span style=color:#e06c75>supplyAsync</span>(() <span style=color:#56b6c2>-&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#c678dd>if</span> (<span style=color:#e06c75>throwError</span>) {
</span></span><span style=display:flex><span>        <span style=color:#c678dd>throw</span> <span style=color:#c678dd>new</span> <span style=color:#e06c75>IllegalArgumentException</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;MicroSoft &#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>    <span style=color:#c678dd>return</span> <span style=color:#98c379>&#34;MicroSoft&#34;</span>;
</span></span><span style=display:flex><span>}).<span style=color:#e06c75>exceptionally</span>(<span style=color:#e06c75>ex</span><span style=color:#56b6c2>-&gt;</span>{
</span></span><span style=display:flex><span>    <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#e06c75>ex</span>);
</span></span><span style=display:flex><span>    <span style=color:#c678dd>return</span> <span style=color:#98c379>&#34;Error&#34;</span>;
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#e06c75>msFuture</span>.<span style=color:#e06c75>get</span>());
</span></span></code></pre></div><br><h4 id=handlebifunction>handle(BiFunction)</h4><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#e5c07b>boolean</span> <span style=color:#e06c75>throwError</span> <span style=color:#56b6c2>=</span> <span style=color:#e5c07b>false</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>CompletableFuture</span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>String</span><span style=color:#56b6c2>&gt;</span> <span style=color:#e06c75>msFuture</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>CompletableFuture</span>.<span style=color:#e06c75>supplyAsync</span>(() <span style=color:#56b6c2>-&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#c678dd>if</span> (<span style=color:#e06c75>throwError</span>) {
</span></span><span style=display:flex><span>        <span style=color:#c678dd>throw</span> <span style=color:#c678dd>new</span> <span style=color:#e06c75>IllegalArgumentException</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#98c379>&#34;MicroSoft &#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e06c75>Thread</span>.<span style=color:#e06c75>currentThread</span>().<span style=color:#e06c75>getName</span>());
</span></span><span style=display:flex><span>    <span style=color:#c678dd>return</span> <span style=color:#98c379>&#34;MicroSoft&#34;</span>;
</span></span><span style=display:flex><span>}).<span style=color:#e06c75>handle</span>((<span style=color:#e06c75>result</span>, <span style=color:#e06c75>ex</span>)<span style=color:#56b6c2>-&gt;</span>{
</span></span><span style=display:flex><span>    <span style=color:#c678dd>if</span> (<span style=color:#e06c75>Objects</span>.<span style=color:#e06c75>nonNull</span>(<span style=color:#e06c75>ex</span>)) {
</span></span><span style=display:flex><span>        <span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#e06c75>ex</span>);
</span></span><span style=display:flex><span>        <span style=color:#c678dd>return</span> <span style=color:#98c379>&#34;ERROR&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#c678dd>return</span> <span style=color:#e06c75>result</span>;
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>System</span>.<span style=color:#e06c75>out</span>.<span style=color:#e06c75>println</span>(<span style=color:#e06c75>msFuture</span>.<span style=color:#e06c75>get</span>());
</span></span></code></pre></div><br><h3 id=8-completablefuture-를-언제-쓸-수-있을까>8) CompletableFuture 를 언제 쓸 수 있을까</h3><p>아래는 microservices.io 사이트에서 가져온 예제이다.</p><img title=system-path loading=lazy decoding=async src=https://user-images.githubusercontent.com/42997924/142424985-840b9ddd-6f97-49f1-abc8-f34fa9f5918b.png alt=alter-text class="img img-fluid img-center" width height><p>CompletableFuture 를 사용할 만한 부분은 API GATEWAY, Storefront WebApp 라고 할 수 있다. 이유는 Account, Inventory, Shipping Service 는 DATA BASE 와 연동하고 있기 때문이다. java 환경에서 RDBMS 연동시에 아직 Async 한 인터페이스 방식을 제공하고 있지 않기 때문에 Async 개발을 해서 큰 효과를 얻기 부족하다.</p><p>하지만, GATEWAY 등은 REST Service 와 연동하기 때문에 Async 를 통한 성능 효과를 볼 수 있다. (Blocking Thread 문제 해결 등)</p><p><br><br><br></p><hr><h2 id=reference>Reference</h2><ul><li><a href="https://www.hungrydiver.co.kr/bbs/detail/develop?id=2" target=_blank>https://www.hungrydiver.co.kr/bbs/detail/develop?id=2</a></li><li><a href=https://kwonnam.pe.kr/wiki/java/8/completable_future target=_blank>https://kwonnam.pe.kr/wiki/java/8/completable_future</a></li><li><a href=https://huisam.tistory.com/entry/completableFuture target=_blank>https://huisam.tistory.com/entry/completableFuture</a></li><li><a href=https://tourspace.tistory.com/137 target=_blank>https://tourspace.tistory.com/137</a></li><li><a href=https://bbubbush.tistory.com/23 target=_blank>https://bbubbush.tistory.com/23</a></li></ul></div><div class="row items-start justify-between mt-24"><div class="lg:col-5 mb-10 flex items-center lg:mb-0"><h5 class=mr-3>Tags :</h5><ul><li class=inline-block><a class="bg-theme-light hover:bg-primary dark:bg-darkmode-theme-light dark:hover:bg-darkmode-primary dark:hover:text-dark m-1 block rounded px-3 py-1 hover:text-white" href=/tags/java/>Java</a></li></ul></div><div class="lg:col-5 flex items-center"><div class=share-icons><h5 class=share-title>Share :</h5><a class="share-link share-facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fgowoonsori.com%2fblog%2fjava%2fcompletablefuture%2f" target=_blank rel=noopener aria-label="share facebook"><span class=share-icon><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"/></svg></span></a><a class="share-link share-twitter" href="https://twitter.com/intent/tweet/?text=Share&amp;url=https%3a%2f%2fgowoonsori.com%2fblog%2fjava%2fcompletablefuture%2f" target=_blank rel=noopener aria-label="share twitter"><span aria-hidden=true class=share-icon><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5.0-4.55 2.04-4.55 4.54.0.36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3.0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35.0 12.92-6.92 12.92-12.93.0-.2.0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"/></svg></span></a><a class="share-link share-email" href="mailto:?subject=Share&amp;body=https%3a%2f%2fgowoonsori.com%2fblog%2fjava%2fcompletablefuture%2f" target=_self rel=noopener aria-label="share email"><span aria-hidden=true class=share-icon><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22 4H2C.9 4 0 4.9.0 6v12c0 1.1.9 2 2 2h20c1.1.0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7.25 14.43l-3.5 2c-.08.05-.17.07-.25.07-.17.0-.34-.1-.43-.25-.14-.24-.06-.55.18-.68l3.5-2c.24-.14.55-.06.68.18.14.24.06.55-.18.68zm4.75.07c-.1.0-.2-.03-.27-.08l-8.5-5.5c-.23-.15-.3-.46-.15-.7.15-.22.46-.3.7-.14L12 13.4l8.23-5.32c.23-.15.54-.08.7.15.14.23.07.54-.16.7l-8.5 5.5c-.08.04-.17.07-.27.07zm8.93 1.75c-.1.16-.26.25-.43.25-.08.0-.17-.02-.25-.07l-3.5-2c-.24-.13-.32-.44-.18-.68s.44-.32.68-.18l3.5 2c.24.13.32.44.18.68z"/></svg></span></a><a class="share-link share-reddit" href="https://reddit.com/submit/?url=https%3a%2f%2fgowoonsori.com%2fblog%2fjava%2fcompletablefuture%2f&amp;resubmit=true&amp;title=Share" target=_blank rel=noopener aria-label="share reddit"><span aria-hidden=true class=share-icon><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M24 11.5c0-1.65-1.35-3-3-3-.96.0-1.86.48-2.42 1.24-1.64-1-3.75-1.64-6.07-1.72.08-1.1.4-3.05 1.52-3.7.72-.4 1.73-.24 3 .5C17.2 6.3 18.46 7.5 20 7.5c1.65.0 3-1.35 3-3s-1.35-3-3-3c-1.38.0-2.54.94-2.88 2.22-1.43-.72-2.64-.8-3.6-.25-1.64.94-1.95 3.47-2 4.55-2.33.08-4.45.7-6.1 1.72C4.86 8.98 3.96 8.5 3 8.5c-1.65.0-3 1.35-3 3 0 1.32.84 2.44 2.05 2.84-.03.22-.05.44-.05.66.0 3.86 4.5 7 10 7s10-3.14 10-7c0-.22-.02-.44-.05-.66 1.2-.4 2.05-1.54 2.05-2.84zM2.3 13.37C1.5 13.07 1 12.35 1 11.5c0-1.1.9-2 2-2 .64.0 1.22.32 1.6.82-1.1.85-1.92 1.9-2.3 3.05zm3.7.13c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm9.8 4.8c-1.08.63-2.42.96-3.8.96-1.4.0-2.74-.34-3.8-.95-.24-.13-.32-.44-.2-.68.15-.24.46-.32.7-.18 1.83 1.06 4.76 1.06 6.6.0.23-.13.53-.05.67.2.14.23.06.54-.18.67zm.2-2.8c-1.1.0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm5.7-2.13c-.38-1.16-1.2-2.2-2.3-3.05.38-.5.97-.82 1.6-.82 1.1.0 2 .9 2 2 0 .84-.53 1.57-1.3 1.87z"/></svg></span></a></div></div></div><div class=mt-16 id=giscusContainer><script>document.addEventListener("DOMContentLoaded",function(){const t={src:"https://giscus.app/client.js","data-repo":"gowoonsori/blog-comments","data-repo-id":"MDEwOlJlcG9zaXRvcnkyOTc4MTY3NDc=","data-category":"Comments","data-category-id":"DIC_kwDOEcBSq84CVvNv","data-mapping":"pathname","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"1","data-input-position":"top","data-theme":getGiscusTheme(),"data-lang":"ko",crossorigin:"anonymous","data-loading":"lazy",async:""},e=document.createElement("script");Object.entries(t).forEach(([t,n])=>e.setAttribute(t,n)),document.getElementById("giscusContainer").appendChild(e)})</script></div></article></div><div class="section pb-0 pt-32"><h2 class="h3 mb-12">Related Posts</h2><div class=row><div class="lg:col-4 mb-16"><div class="bg-body dark:bg-darkmode-body"><a href=/blog/algorithms/prim/><div class="mb-6 w-full rounded px-12 preview empty-preview-box image-random-4"><span>[MST] Prim 알고리즘</span></div></a><h4 class=mb-3><a href=/blog/algorithms/prim/ class=title>[MST] Prim 알고리즘</a></h4><ul class=mb-4><li class="mr-4 inline-block"><i class="fa-regular fa-folder mr-2"></i>
<a href=/categories/algorithm/ class=ms-1>Algorithm</a></li><li class="mr-4 inline-block"><i class="fa-regular fa-clock mr-2"></i>
2021년 4월 12일</li></ul><p class="mb-6 excerpt">우선순위 큐의 방법을 이용하는 알고리즘으로 vertex를 한개씩 선택하며 최소 비용의 edge를 찾는 방법이다. decrease-key의 개념을 이용하며 decrease-key는 현재 계산된 v노드까지의 거리보다 현재 노드 u부터 v까지의 경로가 더 작다면 값을 갱신해주는 방법을 이용한다. 1. 특징 정점 선택 기반 시작 정점부터 출발하여...</p><a class="btn btn-outline-primary btn-sm" href=/blog/algorithms/prim/>Read More</a></div></div><div class="lg:col-4 mb-16"><div class="bg-body dark:bg-darkmode-body"><a href=/blog/projects/hugo/google-analytics/><img src=/images/projects/hugo/preview.png alt="Google Analytics 추가하기" class="mb-6 w-full rounded preview" width=392 height=172></a><h4 class=mb-3><a href=/blog/projects/hugo/google-analytics/ class=title>Google Analytics 추가하기</a></h4><ul class=mb-4><li class="mr-4 inline-block"><i class="fa-regular fa-folder mr-2"></i>
<a href=/categories/projects/ class=ms-1>Projects</a></li><li class="mr-4 inline-block"><i class="fa-regular fa-clock mr-2"></i>
2022년 2월 7일</li></ul><p class="mb-6 excerpt">개인마다 선택한 Theme에 이미 구글 애널리틱스 삽입 코드가 포함되어 있어 config.toml 파일에 추적코드만 삽입하면 되는 경우가 대부분일 것이다. 이 부분은 선택한 theme 문서를 잘 확인해보고 만약에 없다면 아래와 같은 방법으로 추가해줄 수 있다. 1. Google Analytics 추적 코드 발급 구글 애널리틱스를 추가하기 위해서는 당연히 구글의 애널리틱스에 가입을 먼저 해야 한다. 가입을 하...</p><a class="btn btn-outline-primary btn-sm" href=/blog/projects/hugo/google-analytics/>Read More</a></div></div><div class="lg:col-4 mb-16"><div class="bg-body dark:bg-darkmode-body"><a href=/blog/books/developing-ms-starting-with-ddd/><img src=/images/books/developing-ms-starting-with-ddd/preview.png alt="도메인 주도 설계로 시작하는 마이크로 서비스 개발" class="mb-6 w-full rounded preview" width=392 height=172></a><h4 class=mb-3><a href=/blog/books/developing-ms-starting-with-ddd/ class=title>도메인 주도 설계로 시작하는 마이크로 서비스 개발</a></h4><ul class=mb-4><li class="mr-4 inline-block"><i class="fa-regular fa-folder mr-2"></i>
<a href=/categories/books/ class=ms-1>Books</a></li><li class="mr-4 inline-block"><i class="fa-regular fa-clock mr-2"></i>
2021년 12월 27일</li></ul><p class="mb-6 excerpt">1. 마이크로서비스를 위한 조건 1) 업무 기능 중심의 팀 기술별로 팀이 나눠지게 되면 서비스 한개를 개발하는데 많은 의사소통이 필요하고 의사결정이 느려진다. 업무기능을 중심으로 다양한 기술을 가진 사람들이 하나의 팀이 되어 서비스를 만들어야 한다. 2) 폴리글랏 프로그래밍 각각의 서비스에 맞는 효율적인 방법론과 도구, 기술을 찾아 적용. 3) 개발 생명주기...</p><a class="btn btn-outline-primary btn-sm" href=/blog/books/developing-ms-starting-with-ddd/>Read More</a></div></div></div></div></div></section></main><footer class="bg-theme-light dark:bg-darkmode-theme-light"><div class=container><div class="row items-center py-10"><div class="lg:col-3 mb-8 text-center lg:mb-0 lg:text-left"><a class="navbar-brand inline-block" href=/><img fetchpriority=high decoding=async class="img logo-light" width=160 height=32 src=/images/logo_huecbda5afdfa6f2a47d87fa44d8964534_89529_320x0_resize_q90_h2_lanczos_3.webp alt=Gromit.Blog onerror='this.onerror=null,this.src="/images/logo_huecbda5afdfa6f2a47d87fa44d8964534_89529_320x0_resize_lanczos_3.png"'>
<img fetchpriority=high decoding=async class="img logo-dark" width=160 height=32 src=/images/logo-darkmode_hu2877729f4be0141a60f84355100d8d94_80775_320x0_resize_q90_h2_lanczos_3.webp alt=Gromit.Blog onerror='this.onerror=null,this.src="/images/logo-darkmode_hu2877729f4be0141a60f84355100d8d94_80775_320x0_resize_lanczos_3.png"'></a></div><div class="lg:col-6 mb-8 text-center lg:mb-0"><ul></ul></div><div class="lg:col-3 mb-8 text-center lg:mb-0 lg:mt-0 lg:text-right"><ul class=social-icons><li><a target=_blank aria-label=github rel="nofollow noopener" href=https://www.github.com/gowoonsori><i class="fab fa-github"></i></a></li><li><a target=_blank aria-label=linkedin rel="nofollow noopener" href=https://www.linkedin.com/gowoonsori><i class="fab fa-linkedin"></i></a></li><li><a target=_blank aria-label=google rel="nofollow noopener" href=mailto:gowoonsori97@gmail.com><i class="fa-brands fa-google"></i></a></li></ul></div></div></div><div class="border-border dark:border-darkmode-border border-t py-7"><div class="text-light dark:text-darkmode-light container text-center"><p>Developed by <a href=https://github.com/gowoonsori target=_blank>gowoonsori</a></p></div></div></footer><script crossorigin=anonymous integrity="sha256-9XjLB273Xjrt3cq3LF2zQa+fq0rSKxgrV0Hgs1nCeBY=" src=/js/script.min.f578cb076ef75e3aedddcab72c5db341af9fab4ad22b182b5741e0b359c27816.js></script><script crossorigin=anonymous integrity="sha256-B6xkgfh/Kvqv5KhwfzCl2bDxX83d75UmDJHTJqlOs3M=" src=/js/script-lazy.min.07ac6481f87f2afaafe4a8707f30a5d9b0f15fcdddef95260c91d326a94eb373.js defer></script><script>"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js")</script><script>const path=window.location.pathname;path.match(/^\/algorithm.*/)?window.location.replace(`/blog${path}`.replace("algorithm","algorithms")):path.match(/^\/data-structure.*/)?window.location.replace(`/blog${path}`.replace("data-structure","datastructure").replace("tree/","")):path.match(/^\/java\/listtoarray_arraytolist.*/)?window.location.replace("/blog/java/list-array"):path.match(/^\/go.*/)?window.location.replace(`/blog${path}`.replace("/go","/golang")):path.match(/^\/(java|projects|settings|spring|error).*/)&&window.location.replace(`/blog${path}`)</script></body></html>